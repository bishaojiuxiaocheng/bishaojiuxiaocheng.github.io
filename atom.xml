<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://bishaojiuxiaocheng.github.io</id>
    <title>å°æ©™</title>
    <updated>2020-04-05T14:49:37.985Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://bishaojiuxiaocheng.github.io"/>
    <link rel="self" href="https://bishaojiuxiaocheng.github.io/atom.xml"/>
    <subtitle>ä½ æ¸´æœ›æˆä¸ºç¾å°‘å¥³æˆ˜å£«å—ï¼Ÿ</subtitle>
    <logo>https://bishaojiuxiaocheng.github.io/images/avatar.png</logo>
    <icon>https://bishaojiuxiaocheng.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, å°æ©™</rights>
    <entry>
        <title type="html"><![CDATA[Flask è·¨åŸŸè¯·æ±‚é—®é¢˜]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/flask-kua-yu-qing-qiu-wen-ti</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/flask-kua-yu-qing-qiu-wen-ti">
        </link>
        <updated>2020-04-05T14:34:38.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>è®°å½•ä¸€æ¬¡å¼€å‘åç«¯apiä¸­é‡åˆ°çš„è·¨åŸŸè¯·æ±‚é—®é¢˜</p>
</blockquote>
<p>å½“ä½¿ç”¨jså‘é€postè¯·æ±‚æ•°æ®æ—¶ï¼Œå‘ç”Ÿå¦‚ä¸‹é”™è¯¯ï¼š</p>
<ul>
<li><strong>è¯·æ±‚ä»£ç </strong><pre><code class="language-javascript">var httpRequest = new XMLHttpRequest();//ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºéœ€è¦çš„å¯¹è±¡
  	httpRequest.open('POST', 'http://127.0.0.1:5000/api/weapon', true); //ç¬¬äºŒæ­¥ï¼šæ‰“å¼€è¿æ¥
  	httpRequest.setRequestHeader(&quot;Content-type&quot;,&quot;application/json&quot;);//è®¾ç½®è¯·æ±‚å¤´ æ³¨ï¼špostæ–¹å¼å¿…é¡»è®¾ç½®è¯·æ±‚å¤´ï¼ˆåœ¨å»ºç«‹è¿æ¥åè®¾ç½®è¯·æ±‚å¤´ï¼‰
  	var obj = {
      &quot;name&quot;: &quot;åŒ•é¦–&quot;, 
      &quot;infusion&quot;: &quot;é”‹åˆ©&quot;,
      &quot;level&quot;: 10,
      &quot;strength&quot;: 66, 
      &quot;agility&quot;: 80, 
      &quot;magic&quot;: 99,
      &quot;faith&quot;: 99,
      &quot;luck&quot;: 99, 
      &quot;status&quot;: true, 
  };
  	httpRequest.send(JSON.stringify(obj));//å‘é€è¯·æ±‚ å°†jsonå†™å…¥sendä¸­
  	httpRequest.onreadystatechange = function () {//è¯·æ±‚åçš„å›è°ƒæ¥å£ï¼Œå¯å°†è¯·æ±‚æˆåŠŸåè¦æ‰§è¡Œçš„ç¨‹åºå†™åœ¨å…¶ä¸­
  	    if (httpRequest.readyState == 4 &amp;&amp; httpRequest.status == 200) {//éªŒè¯è¯·æ±‚æ˜¯å¦å‘é€æˆåŠŸ
  	        var json = httpRequest.responseText;//è·å–åˆ°æœåŠ¡ç«¯è¿”å›çš„æ•°æ®
  	        window.alert(json);
  	    }
  };
</code></pre>
</li>
<li><strong>è¿”å›çš„é”™è¯¯ï¼š</strong></li>
</ul>
<pre><code>Access to XMLHttpRequest at 'http://127.0.0.1:5000/api/weapon' from origin 'chrome-search://local-ntp' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.
VM254:15 POST http://127.0.0.1:5000/api/weapon net::ERR_FAILED
</code></pre>
<p>ç»è¿‡æŸ¥è¯¢ï¼Œå‘ç°æ—¶è·¨åŸŸè¯·æ±‚çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡<strong>flask-cors</strong>æ¨¡å—è§£å†³<br>
<strong>flask-cors å¯ä»¥è®¾ç½®æˆå…¨å±€ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æˆå•ä¸€ç‹¬ç«‹çš„</strong></p>
<ul>
<li>å…¨å±€</li>
</ul>
<pre><code class="language-python">from flask import Flask
from flask_cors import *
app = Flask(__name__)
CORS(app, supports_credentials=True)
</code></pre>
<ul>
<li>å•ä¸€ç‹¬ç«‹</li>
</ul>
<p>åœ¨è·¯ç”±æ·»åŠ <code>@cross_origin()</code>å³å¯</p>
<pre><code class="language-python">from flask_cors import *

@api.route('/weapon', methods=['POST'])
@cross_origin()
def weapon():
    pass

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[VPS å®‰è£…filebrowseråšä¸€ä¸ªå°å‹çš„ç§äººç½‘ç›˜]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/vps-an-zhuang-filebrowser-zuo-yi-ge-xiao-xing-de-si-ren-wang-pan</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/vps-an-zhuang-filebrowser-zuo-yi-ge-xiao-xing-de-si-ren-wang-pan">
        </link>
        <updated>2020-02-17T12:18:21.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>ç»§ä¸Šæ¬¡çš„vpså®‰è£…manjaroååˆå†æ­å»ºçš„ä¸€ä¸ªæœåŠ¡ï¼Œä¸ºäº†é˜²æ­¢æˆ‘çš„çˆ†æ»¡çš„ç¡¬ç›˜å‡ºç°æ„å¤–ï¼ŒæŠŠä¸€äº›**æ”¾åœ¨äº‘ç«¯ã€‚<br>
é¢˜å¤–è¯ï¼Œ vultrçš„æ—¥æœ¬èŠ‚ç‚¹ï¼Œå¯¹ç§»åŠ¨å’Œç”µä¿¡çš„çº¿è·¯éƒ½ä¸å¤ªå‹å¥½ã€‚ã€‚ã€‚</p>
</blockquote>
<p>èµ·åˆï¼Œ æ‰“ç®—ç›´æ¥åœ¨éƒ¨ç½²çš„ï¼Œ ä½†æ˜¯ç”±äºä¸ªäººèƒ½åŠ›é—®é¢˜ï¼Œæœ€ç»ˆå¤±è´¥å‘Šç»ˆã€‚ã€‚ã€‚<br>
<u>æ— æ³•è¿œç¨‹è®¿é—®ï¼Œåº”è¯¥æ˜¯caddyåå‘ä»£ç†é…ç½®é”™äº†ï¼Œ å¯æ˜¯æˆ‘å½“æ—¶æ€ä¹ˆæ²¡æƒ³åˆ°frpå‘¢ï¼Ÿ</u></p>
<p>æ²¡åŠæ³•ï¼Œé‚£å°±ç”¨dockerå§ã€‚</p>
<ul>
<li><strong>å…ˆå®‰è£…ä¸ªdocker</strong></li>
</ul>
<pre><code class="language-sh">sudo pacman -Sy docker
# sudo systemctl enable --now docker // è¿™æ˜¯æ–°getåˆ°çš„å¯åŠ¨æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯çš„æ–¹æ³•
sudo systemctl start docker # å¯åŠ¨docker
sudo docker info # æŸ¥çœ‹å¯åŠ¨æ˜¯å¦æˆåŠŸ
sudo systemctl enable docker # å¼€æœºè‡ªå¯
</code></pre>
<ul>
<li><strong>æŠŠfilebrowserçš„é•œåƒpullä¸‹æ¥ï¼Œ å¯åŠ¨</strong></li>
</ul>
<pre><code class="language-sh">sudo docker pull filebrowser/filebrowser # æ‹‰å–filebrowserå®˜æ–¹é•œåƒ
sudo mkdir -p /src/filebrowser/site # åˆ›å»ºæ–‡ä»¶ä¿å­˜ç›®å½•
sudo docker run -d \ # åå°è¿è¡Œ
--restart=always \ # æ€»æ˜¯è‡ªåŠ¨é‡å¯
--name  filebrowser  filebrowser/filebrowser \ 
-v /srv/filebrowser/site/root:/srv \ #æ˜ å°„å®¿ä¸»æœºçš„ /srv/filebrowser/site/root åˆ°å®¹å™¨çš„ /srv
-v /data/filebrowser/filebrowserconfig.json:/etc/config.json \ # æŠŠé…ç½®æ–‡ä»¶æ˜ å°„å‡ºæ¥ï¼Œæ–¹ä¾¿åæœŸä¿®æ”¹
-v /data/filebrowser/database.db:/etc/database.db \ # æŠŠæ•°æ®åº“æ–‡ä»¶æ˜ å°„å‡ºæ¥ï¼Œæ–¹ä¾¿å¤‡ä»½è¿ç§»
-p 80:80 \ # æŠŠå®¹å™¨çš„çš„80ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„80ç«¯å£
</code></pre>
<blockquote>
<p><code>--name</code>ï¼šç»™è¿è¡Œçš„å®¹å™¨èµ·ä¸ªåï¼Œ ä¸ç„¶å°±æ˜¯ä¸€å †æ— è§„å¾‹çš„æ•°å­—å’Œå­—æ¯<br>
<code>-v</code>ï¼šè¡¨ç¤ºæŠŠå®¿ä¸»æœºçš„æŸæ–‡ä»¶æˆ–ç›®å½•æŒ‚è½½ï¼ˆæˆ–è€…å«æ˜ å°„ï¼Ÿï¼‰åˆ°å®¹å™¨ï¼Œâ€˜ ï¼šâ€™å‰æ˜¯å®¿ä¸»æœºï¼Œ åæ˜¯å®¹å™¨<br>
<code>-p</code>ï¼š ç«¯å£æ˜ å°„ï¼Œ æŠŠå®¹å™¨çš„æŸç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„æŸç«¯å£ï¼Œ â€˜ ï¼šâ€™å‰æ˜¯å®¿ä¸»æœºï¼Œ åæ˜¯å®¹å™¨</p>
</blockquote>
<ul>
<li><strong>é˜²ç«å¢™å¼€æ”¾ç«¯å£</strong></li>
<li><strong>ç™»å½•filebrowserï¼Œé»˜è®¤çš„ç”¨æˆ·å’Œå¯†ç éƒ½æ˜¯adminï¼Œä¿®æ”¹é»˜è®¤é…ç½®</strong></li>
</ul>
<blockquote>
<blockquote>
<p>æœ€åè¯´ä¸€å¥ï¼šdockerçœŸçš„å¤ªæ–¹ä¾¿äº†ã€‚ã€‚ã€‚ã€‚</p>
</blockquote>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Flask-SQLALchemy çš„ç”¨æ³•]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/flask-sqlalchemy-de-yong-fa</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/flask-sqlalchemy-de-yong-fa">
        </link>
        <updated>2020-02-12T09:24:11.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>Python 3.7.4<br>
flask 1.1.1</p>
</blockquote>
<h1 id="åˆ›å»ºflaskåº”ç”¨å®ä¾‹">åˆ›å»ºflaskåº”ç”¨å®ä¾‹</h1>
<p>æˆ‘æ¯”è¾ƒå–œæ¬¢ç”¨ å·¥å‚å‡½æ•° çš„æ–¹æ³•æ¥åˆå§‹åŒ–å®ä¾‹</p>
<h2 id="åˆ›å»ºé…ç½®ç±»ç”¨æ¥åˆå§‹åŒ–é…ç½®">åˆ›å»ºé…ç½®ç±»ï¼Œç”¨æ¥åˆå§‹åŒ–é…ç½®</h2>
<pre><code class="language-python">class Config(object):
    DEBUG = True

    SQLALCHEMY_DATABASE_URI = &quot;sqlite:///databasename&quot;    # ç”¨äºè¿æ¥æ•°æ®åº“çš„åœ°å€
    SQLALCHEMY_TRACK_MODIFICATIONS = False   # ç¦ç”¨ è¿½è¸ªå¯¹è±¡çš„ä¿®æ”¹å¹¶ä¸”å‘é€ä¿¡å·
</code></pre>
<p>ç”¨äºè¿æ¥æ•°æ®åº“çš„URIæœ‰å…¶ç‰¹å®šçš„å½¢å¼ï¼š</p>
<pre><code>Postgres:     postgresql://scott:tiger@localhost/mydatabase
MySQL:        mysql://scott:tiger@localhost/mydatabase
Oracle:         oracle://scott:tiger@127.0.0.1:1521/sidname
SQLite:         sqlite:////absolute/path/to/foo.db
</code></pre>
<p><strong>è¿™é‡Œè¦æ³¨æ„ä»¥ä¸‹SQLiteçš„è¯­æ³•ï¼Œ<code>////</code>è¡¨ç¤ºç»å¯¹è·¯å¾„ï¼Œ <code>///</code>è¡¨ç¤ºç›¸å¯¹è·¯å¾„</strong><br>
è¿˜æœ‰æ›´å¤šçš„é…ç½®å‚è€ƒï¼š<code>http://www.pythondoc.com/flask-sqlalchemy/config.html</code></p>
<h2 id="åˆ›å»ºå·¥å‚å‡½æ•°">åˆ›å»ºå·¥å‚å‡½æ•°</h2>
<pre><code class="language-python">from flask import Flask
from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

def create_app(config_name):
    app = Flask(__name__)
    app.config.from_object(config_name)

    db.app = app
    db.init_app(app)

    return app
</code></pre>
<h2 id="å»ºç«‹æ•°æ®åº“æ¨¡å‹">å»ºç«‹æ•°æ®åº“æ¨¡å‹</h2>
<p>å»ºç«‹æ•°æ®åº“æ¨¡å‹éœ€è¦ç”¨åˆ°<code>db.Model</code></p>
<pre><code class="language-python">import db #å¯¼å…¥åˆ›å»ºå¥½çš„db

class Demo(db.Model):
    __tabelname__ = 'demo'  # è¡¨å

    id = db.Column(db.Integer, primary_key=True)   # db.Columnå®šä¹‰ä¸€åˆ—ï¼Œ primary_key=True è¡¨ç¤ºä¸»é”®
    user = db.Column('user', db.String(32)) # é»˜è®¤å˜é‡åä¸ºåˆ—åï¼Œ ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šä¸åŒçš„åˆ—å
    def __init__(self, user):
        self.user = user
</code></pre>
<p>Columnå¸¸ç”¨çš„ç±»å‹ï¼š</p>
<ul>
<li>Integer :             æ•´æ•°</li>
<li>String(size):       é•¿åº¦é™åˆ¶sizeçš„å­—ç¬¦ä¸²</li>
<li>Textï¼š                unicodeæ–‡æœ¬</li>
<li>DateTimeï¼š       è¡¨ç¤ºä¸º Python datetime å¯¹è±¡çš„ æ—¶é—´å’Œæ—¥æœŸ</li>
<li>Floatï¼š	            å­˜å‚¨æµ®ç‚¹å€¼</li>
<li>Booleanï¼š         å­˜å‚¨å¸ƒå°”å€¼</li>
<li>PickleTypeï¼š	  å­˜å‚¨ä¸ºä¸€ä¸ªæŒä¹…åŒ–çš„ Python å¯¹è±¡</li>
<li>LargeBinaryï¼š	  å­˜å‚¨ä¸€ä¸ªä»»æ„å¤§çš„äºŒè¿›åˆ¶æ•°æ®</li>
</ul>
<h2 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h2>
<pre><code class="language-python">app = create_app(Config)
</code></pre>
<h1 id="å¯¹æ•°æ®åº“çš„ç›¸å…³æ“ä½œ">å¯¹æ•°æ®åº“çš„ç›¸å…³æ“ä½œ</h1>
<p>åˆå§‹åŒ–appåï¼Œåœ¨éœ€è¦ç”¨çš„åœ°æ–¹å¯¼å…¥ <code>db</code> å°±å¯ä»¥è¿›è¡Œæ•°æ®åº“ç›¸å…³æ“ä½œäº†ï¼Œ <strong>å¦‚æœè¦å†™å…¥æ•°æ®åº“éœ€è¦æäº¤<code>db.session.commit()</code></strong></p>
<h2 id="å¢">å¢</h2>
<p>æ·»åŠ æ•°æ®æœ‰<code>session.add()</code>, <code>session.add_all(*list)</code></p>
<h3 id="sessionadd-æ·»åŠ å•æ¡æ•°æ®">session.add() æ·»åŠ å•æ¡æ•°æ®</h3>
<ol>
<li>å®ä¾‹åŒ–ä¸€ä¸ªæ•°æ®åº“æ¨¡å‹ç±»ï¼š<code>who = Demo('bishaojiuxiaocheng')</code></li>
<li>æŠŠ<code>who</code>æ·»åŠ åˆ°ä¼šè¯ä¸­ï¼š<code>db.session.add(who)</code></li>
<li>æäº¤</li>
</ol>
<h3 id="sessionadd_alllist-æ·»åŠ å¤šæ¡æ•°æ®">session.add_all(*list) æ·»åŠ å¤šæ¡æ•°æ®</h3>
<ol>
<li>ä¼ å…¥ä¸€ç»„æ•°æ®åº“æ¨¡å‹ç±»å®ä¾‹åŒ–çš„åˆ—è¡¨: <code>user_list = [_ for _ in ['a', 'b', 'c', 'd']]</code></li>
<li><code>db.session.add(*user_list)</code></li>
<li>æäº¤</li>
</ol>
<h2 id="åˆ ">åˆ </h2>
<p>pass</p>
<h2 id="æŸ¥">æŸ¥</h2>
<p>æŸ¥è¯¢ç”¨<code>query</code>å±æ€§ï¼Œ ç”¨<code>filter()</code>æˆ–è€…<code>filter_by()</code>è¿‡æ»¤ï¼Œ ç”¨ <code>first()</code>å’Œ<code>all()</code>è·å–æŸ¥è¯¢åˆ°çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨<code>limit(size)</code>æ¥é™åˆ¶è¿”å›çš„ä¸ªæ•°ï¼›ä¸»é”®çš„æŸ¥è¯¢å¯ç”¨<code>get()</code>æ–¹æ³•<br>
<strong>å½“æŸ¥è¯¢ä¸åˆ°å¯¹è±¡æ—¶ï¼Œè¿”å›<code>None</code></strong></p>
<blockquote>
<p>æœªå®Œï¼Œå¾…åç»­è¡¥å……ã€‚ã€‚ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Python OSæ¨¡å—ç›¸å…³ç”¨æ³•]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/python-os-mo-kuai-xiang-guan-yong-fa</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/python-os-mo-kuai-xiang-guan-yong-fa">
        </link>
        <updated>2020-02-12T08:57:11.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>è®°å½•æ‰€ç”¨åˆ°çš„osåº“çš„ç›¸å…³æ–¹æ³•å’Œç”¨æ³•ï¼Œ æŒç»­æ›´æ–°<br>
Python 3.7.4</p>
</blockquote>
<h1 id="os-æ¨¡å—">os æ¨¡å—</h1>
<h2 id="osgetcwd-è¿”å›å½“å‰å·¥ä½œç›®å½•">os.getcwd() è¿”å›å½“å‰å·¥ä½œç›®å½•</h2>
<blockquote>
<p>è¯¥å‡½æ•°ä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œå®ƒè¿”å›å½“å‰å·¥ä½œçš„ç›®å½•ã€‚è¿”å›å­—ç¬¦ä¸²ç±»å‹</p>
</blockquote>
<pre><code class="language-python">import os
print(os.getcwd())
</code></pre>
<p>è¿è¡Œåè¾“å‡ºï¼š<br>
<code>'D:\\Works\\Programs\\Python\\darksouls3'</code><br>
å¯ä»¥é…åˆ <code>os.path.join()</code>æ–¹æ³•æŠŠå½“å½“å‰ç›®å½•ä¸‹çš„æŸä¸ªç›®å½•æˆ–è€…æ–‡ä»¶è½¬æ¢ä¸ºç»å¯¹è·¯å¾„</p>
<h1 id="ospath-æ¨¡å—">os.path æ¨¡å—</h1>
<h2 id="ospathjoinpath1-path2-or-path-æŠŠç›®å½•å’Œæ–‡ä»¶ååˆæˆä¸€ä¸ªè·¯å¾„">os.path.join(path1, path2 or [*path]) æŠŠç›®å½•å’Œæ–‡ä»¶ååˆæˆä¸€ä¸ªè·¯å¾„</h2>
<blockquote>
<p>éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ—¶å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨ï¼Œè¿”å›ä¸€ä¸ªæ‹¼æ¥å¥½çš„å­—ç¬¦ä¸²ã€‚<br>
å’Œstr.join()å·®ä¸å¤šï¼Œ åªä¸è¿‡os.path.joinå†…éƒ¨å¸®ä½ å¤„ç†äº†<code>\</code>ï¼Œ<code>/</code>ç­‰é—®é¢˜ï¼Œ <strong>ä½†æ˜¯ä»–ä¸ä¼šå¸®ä½ å¸®ä½ åˆ¤æ–­è¿™ä¸ªç›®å½•æˆ–è€…æ–‡ä»¶æ˜¯å¦å­˜åœ¨</strong></p>
</blockquote>
<pre><code class="language-python">import os
print(os.getcwd(), 'test')
</code></pre>
<p>è¾“å‡ºï¼š<br>
<code>'D:\\Works\\Programs\\Python\\darksouls3\\test'</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Flask-SQLAlchemy ä¸­æ•°æ®åº“è¿æ¥åˆå§‹åŒ–é—®é¢˜]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/flask-sqlalchemy-zhong-shu-ju-ku-lian-jie-chu-shi-hua-wen-ti</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/flask-sqlalchemy-zhong-shu-ju-ku-lian-jie-chu-shi-hua-wen-ti">
        </link>
        <updated>2020-02-12T07:49:10.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å‰è¨€ï¼š flask-sqlalchemyæ˜¯å¯¹sqlalchemyçš„è¿›ä¸€æ­¥å°è£…ã€‚åˆæ¬¡æ¥è§¦æ„Ÿè§‰è¿˜æ˜¯sqlalchemyå¥½ç”¨ä¸€ç‚¹</p>
</blockquote>
<blockquote>
<p>é—®é¢˜å…·ä½“æè¿°ï¼šåœ¨ä¸€æ¬¡Flaskçš„åç«¯å¼€å‘ä¸­ï¼Œä»SQLAlchemyåº“è½¬ç”¨flask-sqlalchemyçš„æ—¶å€™ï¼Œå‡ºç°çš„æ•°æ®åº“è¿æ¥åˆå§‹åŒ–é—®é¢˜ã€‚ç”¨çš„æ˜¯<strong>sqlite</strong>æ•°æ®åº“ï¼Œ èµ·åˆç”¨sqlalchemyè¿æ¥æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œ åœ¨ä¿®æ”¹ä»£ç æ”¹ç”¨flask-sqlalchemyæ˜¯å‡ºç°æ— æ³•è¿æ¥è‡³æ•°æ®åº“ã€‚</p>
</blockquote>
<blockquote>
<p>åŸå› ï¼šåˆå§‹åŒ–å¤±è´¥</p>
</blockquote>
<blockquote>
<p>è§£å†³ï¼šåœ¨<code>db.init_app(app)</code>å‰åŠ ä¸Š<code>db.app = app</code>ï¼Œ å®˜æ–¹å¹¶æ²¡æœ‰æåˆ°è¿™ä¸ªã€‚ã€‚ã€‚</p>
</blockquote>
<h2 id="æˆ‘çš„é¡¹ç›®ç›®å½•ç»“æ„">æˆ‘çš„é¡¹ç›®ç›®å½•ç»“æ„</h2>
<ul>
<li>/
<ul>
<li>DS3db
<ul>
<li>view
<ul>
<li><strong>init</strong>.py</li>
<li>weapon_data.py</li>
</ul>
</li>
</ul>
</li>
<li><strong>init</strong>.py</li>
<li>model.py</li>
<li>app.py</li>
</ul>
</li>
</ul>
<hr>
<p>åœ¨<code>DS3db/__init__.py</code>ä¸­åˆ›å»ºå·¥å‚å‡½æ•°</p>
<pre><code class="language-python">from flask import Flask
from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

def create_app(config_name):
    &quot;&quot;&quot;
    åˆ›å»ºflaskåº”ç”¨å¯¹è±¡
    :param config_name: cls é…ç½®ç±»
    :return: flaskåº”ç”¨å¯¹è±¡
    &quot;&quot;&quot;

    app = Flask(__name__)
    app.config.from_object(config_name)

    db.init_app(app)
    print(db.engine)   ## æŸ¥çœ‹è¿æ¥çŠ¶æ€ï¼Œ æ˜¯åæ¥è¿›è¡ŒæŸ¥è¯¢æ•°æ®åº“æ—¶æ˜¾ç¤ºæ²¡æœ‰ç›¸å…³çš„è¡¨åŠ ä¸Šå»çš„

    from .view import api
    app.register_blueprint(api, url_prefix='/api')

    return app
</code></pre>
<p>åœ¨<code>Config</code>ç±»ä¸­ç¼–å†™appç›¸å…³é…ç½®</p>
<pre><code class="language-python">class Config(object):
    DEBUG = True

    SQLALCHEMY_DATABASE_URI = &quot;sqlite://&quot; + os.path.join(os.getcwd(), &quot;Weapon.db&quot;)    #æ•°æ®åº“æ–‡ä»¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹
    SQLALCHEMY_TRACK_MODIFICATIONS = False
</code></pre>
<p>åœ¨è°ƒç”¨ <code>create_app()</code>å‡½æ•°å ç›´æ¥æŠ¥é”™ï¼š</p>
<pre><code class="language-Traceback">  File &quot;D:/Works/Programs/Python/darksouls3/main.py&quot;, line 13, in &lt;module&gt;
    app = create_app(Config)
  File &quot;D:\Works\Programs\Python\darksouls3\DS3db\__init__.py&quot;, line 19, in create_app
    print(db.engine)
  File &quot;D:\Works\Programs\Python\darksouls3\venv\lib\site-packages\flask_sqlalchemy\__init__.py&quot;, line 937, in engine
    return self.get_engine()
  File &quot;D:\Works\Programs\Python\darksouls3\venv\lib\site-packages\flask_sqlalchemy\__init__.py&quot;, line 946, in get_engine
    app = self.get_app(app)
  File &quot;D:\Works\Programs\Python\darksouls3\venv\lib\site-packages\flask_sqlalchemy\__init__.py&quot;, line 982, in get_app
    'No application found. Either work inside a view function or push'
RuntimeError: No application found. Either work inside a view function or push an application context. See http://flask-sqlalchemy.pocoo.org/contexts/.
</code></pre>
<p>æ˜¾ç„¶ï¼Œ æ˜¯<code>db.init_app(app)</code>è¿™é‡Œå‡ºé”™äº†ï¼Œ æ²¡æœ‰åˆå§‹åŒ–æˆåŠŸï¼Œä½†æ˜¯æŠŠ<code>print(db.engine)</code>æ³¨é‡Šæ‰ï¼Œä»–å°±ä¸ä¼šæŠ¥é”™ï¼Œ å¯¼è‡´åæ¥è¿›è¡Œæ•°æ®æ“ä½œæ—¶ä¸€ç³»åˆ—é”™è¯¯ï¼ˆèµ°äº†å¥½å¤šå¼¯è·¯ã€‚ã€‚ã€‚ï¼‰</p>
<h2 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h2>
<p>åœ¨ <code>create_app()</code>ä¸­çš„<code>db.init_app(app)</code>å‰åŠ ä¸Š<code>db.app = app</code>å°±èƒ½åˆå§‹åŒ–æˆåŠŸã€‚<br>
è¿™æ—¶<code>print(db.engine)</code>å°±ä¸ä¼šæŠ¥é”™ï¼Œ å¹¶æ‰“å°ï¼š<br>
<code>Engine(sqlite:///D:\Works\Programs\Python\darksouls3\DS3db\Weapon.db)</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vultr VPS å®‰è£…Manjaro Linux çš„ä¸€æ¬¡è®°å½•]]></title>
        <id>https://bishaojiuxiaocheng.github.io/post/vultr-vps-an-zhuang-manjaro-linux-de-yi-ci-ji-lu</id>
        <link href="https://bishaojiuxiaocheng.github.io/post/vultr-vps-an-zhuang-manjaro-linux-de-yi-ci-ji-lu">
        </link>
        <updated>2020-02-11T14:11:12.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æ—¶é—´ï¼š2020-02-07<br>
åœ¨ Vultr çš„ VPS ä¸Šå®‰è£…Manjaro Linux i3 ï¼Œå¹¶å®‰è£…é…ç½®shadowsockså’Œv2rayçš„ä¸€æ¬¡è®°å½•<br>
ç¯å¢ƒï¼šVultr 1æ ¸1Gçš„VPS + Manjaro i3 18.1.5</p>
</blockquote>
<h1 id="ç¬¬ä¸€æ­¥å¯¼å…¥manjaroå®‰è£…é•œåƒ">ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥Manjaroå®‰è£…é•œåƒ</h1>
<p>Vultræœ‰å¯ä»¥å®‰è£…è‡ªå®šä¹‰ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œ åªéœ€è¦æŠŠç³»ç»Ÿçš„å®‰è£…é•œåƒä¸Šä¼ å°±å¯ä»¥äº†ï¼Œ ä¹Ÿå¯ä»¥ç”¨urlè®©Vultråå°è‡ªå·±ä¸‹è½½ã€‚ è¿™æ¬¡æˆ‘é‡‡ç”¨urlçš„æ–¹å¼ã€‚</p>
<ol>
<li>è·å–Manjaroçš„å®‰è£…é•œåƒurl<br>
ç”±äºManjaro i3ç‰ˆæœ¬æ˜¯ç¤¾åŒºç‰ˆï¼Œ æ‰€ä»¥è¦åˆ°Manjaroç¤¾åŒºè·å–ç›¸å…³çš„ä¸‹è½½é“¾æ¥<br>
<code>https://dotsrc.dl.osdn.net/osdn/storage/g/m/ma/manjaro-community/i3/18.1.5/manjaro-i3-18.1.5-191229-linux54.iso</code></li>
<li>Upload åˆ° Vultr<br>
åœ¨Vultrçš„ç”¨æˆ·ä¸­å¿ƒæœ‰ä¸ªAdd ISOï¼Œ ç•¥</li>
</ol>
<h1 id="ç¬¬äºŒæ­¥å®‰è£…vpså®ä¾‹">ç¬¬äºŒæ­¥ï¼šå®‰è£…VPSå®ä¾‹</h1>
<p>ç¬¬ä¸‰æ–¹ç³»ç»Ÿåªèƒ½è‡ªå·±æ‰‹åŠ¨å®‰è£…ï¼Œ æ‰€ä»¥åœ¨å®ä¾‹åˆå§‹åŒ–åï¼Œç›´æ¥åœ¨åå°ç®¡ç†ç•Œé¢è¿›å…¥VPSå®‰è£…</p>
<ol>
<li>
<p>Manjaro æ˜¯GUIå®‰è£…ï¼Œ åªéœ€è¦æ³¨æ„ä¸€ä¸‹è¯­è¨€ç¯å¢ƒå’Œç¼–ç ç¯å¢ƒéƒ½é€‰æˆè‹±æ–‡ï¼Œ æ—¶é—´é€‰VPSå¯¹åº”çš„åœ°åŒºï¼Œæ–¹ä¾¿åç»­å®‰è£…v2ray</p>
</li>
<li>
<p>å®‰è£…å®Œæˆå<br>
å…ˆæ›´æ–°<code>pacman -Syyu</code>ï¼ˆéƒ½ä¸éœ€è¦è€ƒè™‘é•œåƒæºçš„é—®é¢˜ğŸ˜Œï¼‰ï¼Œ å†å…³æ‰çª—å£ç®¡ç†å™¨çš„å¼€æœºè‡ªå¯<code>systemctl disable lightdm.service</code></p>
</li>
<li>
<p>å®‰è£…é…ç½®SSH<br>
<code>pacman -S openssh</code><br>
<code>systemctl start sshd.service</code><br>
<code>systemctl enable sshd.service #å¼€æœºè‡ªå¯</code></p>
</li>
<li>
<p>å¼€å¯é˜²ç«å¢™ï¼Œ å¼€æ”¾ç›¸åº”ç«¯å£<br>
<code>ufw enable</code><br>
<code>ufw default deny #é»˜è®¤ç¦æ­¢</code><br>
<code>ufw allow 22</code></p>
</li>
</ol>
<h1 id="ç¬¬ä¸‰æ­¥å®‰è£…sså’Œv2ray">ç¬¬ä¸‰æ­¥ï¼šå®‰è£…SSå’ŒV2ray</h1>
<p>è¿™äº›éƒ½æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼Œ å½“è¿æ¥ä¸ä¸Šçš„æ—¶å€™ï¼Œå…ˆpingä¸€ä¸‹ï¼Œå†æ£€æŸ¥ä¸€ä¸‹é…ç½®ä¿¡æ¯çš„æ­£ç¡®ï¼Œ æœ€åæ£€æŸ¥è¿æ¥ä¿¡æ¯æ˜¯å¦æ­£ç¡®ã€‚<strong>æ³¨ï¼šæœ‰æ—¶å€™æ­»æ´»è¿æ¥ä¸ä¸Šçš„æ—¶å€™ï¼Œæ›´æ¢ä¸€ä¸ªç«¯å£å°±å¥½äº†ï¼Œ è«åå¥‡å¦™</strong></p>
<ul>
<li>
<p>v2ray</p>
<ol>
<li>
<p>å®‰è£…<br>
<code>pacman -S v2ray</code></p>
</li>
<li>
<p>é…ç½®<br>
åˆ›å»ºä¸€ä¸ªç›®å½•ç”¨æ¥ä¿å­˜v2rayçš„log ï¼Œ<code>mkdir -p ~/.logs/v2ray</code><br>
ç¼–å†™<code>/etc/v2ray/config.json</code>ï¼Œ å°±ç®€å•çš„vmessåŠ å¯†å°±å¥½äº†ï¼Œæœ¬æ¥è¿˜åŠ äº†ä¸€ä¸ªmkcpçš„ï¼Œè¢«è¿è¥å•†ã€‚ã€‚ã€‚</p>
</li>
</ol>
<pre><code class="language-json">{
&quot;log&quot;: {
&quot;access&quot;: &quot;/home/.logs/v2ray/access.log&quot;,
&quot;error&quot;: &quot;/home/.logs/v2ray/error.log&quot;,
&quot;loglevel&quot;: &quot;warning&quot;
},
&quot;inbounds&quot;: [{
&quot;listen&quot;:&quot;0.0.0.0&quot;,
&quot;port&quot;: ç«¯å£å·,
&quot;protocol&quot;: &quot;vmess&quot;,
&quot;settings&quot;: {
 &quot;clients&quot;:[
{
   &quot;id&quot;: &quot;UUID&quot;,
   &quot;alterId&quot;: 233
}          
 ]
}
}],
&quot;outbounds&quot;:[{
&quot;protocol&quot;:&quot;freedom&quot;,
&quot;settings&quot;:{}
}]}
</code></pre>
<ol start="3">
<li>è¿è¡Œ<br>
<code>systemctl start v2ray.service</code>,<br>
<code>systemctl enable v2ray.service</code><br>
<code>ufw allow ç«¯å£å·</code></li>
</ol>
</li>
<li>
<p>shadowsocks</p>
<ol>
<li>å®‰è£…ï¼Œ <code>pacman -S shadowsocks-libev</code></li>
<li>é…ç½®<br>
<code>vim /etc/shadowsocks/demo.json</code><pre><code class="language-json">{
&quot;server&quot;:[&quot;::0&quot;,&quot;0.0.0.0&quot;],    //åŒæ—¶ç›‘å¬ipv4å’Œipv6
&quot;server_port&quot;:&quot;ç«¯å£å·&quot;,
&quot;password&quot;:&quot;å¯†ç &quot;,
&quot;timeout&quot;:300,
&quot;method&quot;:&quot;chacha20-ietf-poly1305&quot;,
&quot;fast_open&quot;:true,
}
</code></pre>
</li>
<li>è¿è¡Œ<br>
<code>systemctl start shadowsocks-libev-server@demo.service</code><br>
<code>systemctl enable shadowsocks-libev-server@demo.service</code><br>
<code>ufw allow ç«¯å£å·</code></li>
</ol>
</li>
</ul>
<h1 id="åè®°">åè®°</h1>
<ul>
<li>v2rayåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‡ºç°è¿‡ä¸¤æ¬¡æ— æ³•è¿æ¥ã€‚ ç¬¬ä¸€æ¬¡å…³é—­mkcpåæ¢å¤æ­£å¸¸ï¼Œ ç¬¬äºŒæ¬¡æ›´æ¢ç«¯å£åæ¢å¤æ­£å¸¸</li>
<li>ä¸”è¡Œä¸”çæƒœå§ã€‚</li>
</ul>
]]></content>
    </entry>
</feed>